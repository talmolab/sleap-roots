# Quick Start

This guide will walk you through the basic workflow of using sleap-roots to extract morphological traits from plant root images.

## Prerequisites

Before starting, make sure you have:

1. **Installed sleap-roots** – See [Installation](installation.md)
2. **SLEAP prediction files** – `.slp` files generated by [SLEAP](https://sleap.ai)
3. **Optional: Video files** – `.h5` or `.mp4` files (for frame-by-frame analysis)

!!! info "Don't have SLEAP predictions?"
    You can use the test data included in the repository:
    ```bash
    git clone https://github.com/talmolab/sleap-roots.git
    cd sleap-roots
    git lfs pull  # Download test data
    ```

## Basic Workflow

The typical sleap-roots workflow has three steps:

1. **Load SLEAP predictions** into a `Series` object
2. **Choose a pipeline** appropriate for your plant type
3. **Compute traits** and export to CSV

## Example 1: Single Plant Analysis

Let's analyze a single dicot plant (e.g., soy or canola) with primary and lateral roots:

```python
import sleap_roots as sr

# Step 1: Load SLEAP predictions
series = sr.Series.load(
    series_name="919QDUH",
    h5_path="tests/data/canola_7do/919QDUH.h5",
    primary_path="tests/data/canola_7do/919QDUH.primary.slp",
    lateral_path="tests/data/canola_7do/919QDUH.lateral.slp"
)

# Step 2: Create a pipeline
pipeline = sr.DicotPipeline()

# Step 3: Compute traits
traits_df = pipeline.compute_plant_traits(series, write_csv=True)

# View results
print(traits_df.head())
```

This will:

- Load predictions for primary and lateral roots
- Compute 100+ morphological traits
- Save results to `919QDUH_traits.csv`

## Example 2: Batch Processing

For high-throughput experiments, process multiple plants at once:

```python
import sleap_roots as sr

# Step 1: Find all SLEAP files in a directory
paths = sr.find_all_slp_paths("tests/data/soy_6do")

# Step 2: Load all plants
plants = sr.load_series_from_slps(paths, h5s=True)

# Step 3: Create pipeline and compute batch traits
pipeline = sr.DicotPipeline()
batch_df = pipeline.compute_batch_traits(plants, write_csv=True)

# View summary
print(f"Processed {len(batch_df)} plant frames")
print(batch_df[['plant', 'frame_idx', 'primary_length', 'lateral_count']].head())
```

The batch CSV will contain all plants with columns:

- `plant` – Plant identifier
- `frame_idx` – Frame number (for time-series)
- Individual trait columns

## Example 3: Using Individual Trait Functions

You can also use modular utility functions for custom analyses:

```python
from sleap_roots.lengths import get_root_lengths
from sleap_roots.angles import get_primary_angle
import sleap_roots as sr

# Load data
series = sr.Series.load(
    series_name="my_plant",
    primary_path="primary_roots.slp"
)

# Get points for frame 0
pts = series.get_primary_points(frame_idx=0)

# Compute specific traits
length = get_root_lengths(pts)
angle = get_primary_angle(pts)

print(f"Primary root length: {length:.2f} pixels")
print(f"Primary root angle: {angle:.2f} degrees")
```

## Available Pipelines

Choose a pipeline based on your plant type and root system:

| Pipeline | Use Case | Root Types |
|----------|----------|-----------|
| **DicotPipeline** | Dicots with primary + laterals | Primary, Lateral |
| **YoungerMonocotPipeline** | Young monocots | Primary, Crown |
| **OlderMonocotPipeline** | Mature monocots (no primary) | Crown |
| **MultipleDicotPipeline** | Multi-plant images | Primary, Lateral |
| **PrimaryRootPipeline** | Primary root only | Primary |
| **LateralRootPipeline** | Lateral roots only | Lateral |

See the [Pipeline Guide](../guides/index.md) for detailed information about each pipeline.

## Understanding the Output

### Trait DataFrame Structure

The output DataFrame has one row per frame (or plant-frame for batch processing):

```python
# Example output
     plant  frame_idx  primary_length  lateral_count  primary_angle
0  919QDUH          0          523.45             12          87.32
1  919QDUH          1          541.23             13          86.91
2  919QDUH          2          558.91             14          85.77
```

### Common Traits

Here are some commonly used traits:

- **Length traits** – `primary_length`, `lateral_length_total`, `lateral_length_avg`
- **Count traits** – `lateral_count`, `primary_tip_count`, `crown_count`
- **Angle traits** – `primary_angle`, `lateral_angle_avg`, `crown_angle_avg`
- **Topology traits** – `convex_hull_area`, `network_distribution_ratio`

See the [Trait Reference](../guides/trait-reference.md) for the full list with descriptions.

## Working with CSV Output

The CSV files are compatible with any statistical analysis tool:

### Python (pandas)
```python
import pandas as pd

df = pd.read_csv("919QDUH_traits.csv")
print(df['primary_length'].describe())
```

### R
```r
df <- read.csv("919QDUH_traits.csv")
summary(df$primary_length)
```

### Excel
Simply open the CSV file in Excel or Google Sheets.

## Visualizing Results

```python
import matplotlib.pyplot as plt
import pandas as pd

# Load results
df = pd.read_csv("919QDUH_traits.csv")

# Plot length over time
plt.figure(figsize=(10, 6))
plt.plot(df['frame_idx'], df['primary_length'], label='Primary Root')
plt.plot(df['frame_idx'], df['lateral_length_total'], label='Total Lateral Length')
plt.xlabel('Frame')
plt.ylabel('Length (pixels)')
plt.title('Root Growth Over Time')
plt.legend()
plt.show()
```

## Converting Pixels to Real Units

SLEAP predictions are in pixels. To convert to real-world units (mm, cm):

```python
# Define scale (e.g., 100 pixels = 1 cm)
pixels_per_cm = 100

# Convert traits
df['primary_length_cm'] = df['primary_length'] / pixels_per_cm
df['lateral_length_total_cm'] = df['lateral_length_total'] / pixels_per_cm
```

Determine your scale by:

1. Including a ruler or reference object in images
2. Measuring known distances in pixels
3. Calculating pixels per unit

## Common Issues

### "No module named 'sleap_roots'"

See the [Troubleshooting Guide](../guides/troubleshooting.md#import-errors) for solutions.

### "FileNotFoundError: predictions.slp"

Check that file paths are correct and files exist:
```python
from pathlib import Path
assert Path("primary_roots.slp").exists()
```

### Empty or NaN traits

This can happen if:

- SLEAP predictions are missing for some frames
- Root landmarks weren't detected
- Coordinate systems are misaligned

Check your SLEAP predictions in the SLEAP GUI to verify quality.

### "KeyError: 'primary_pts'"

Make sure you're using the correct pipeline for your data:

- Use `DicotPipeline` for primary + lateral roots
- Use `MonocotPipeline` for crown roots
- Check that you're loading the correct `.slp` files

## Next Steps

- [Learn about SLEAP](what-is-sleap.md) – Understand the prediction workflow
- [Pipeline Guide](../guides/index.md) – Deep dive into each pipeline
- [Trait Reference](../guides/trait-reference.md) – Full list of computed traits
- [Batch Processing](../guides/batch-processing.md) – Advanced batch workflows
- [API Reference](../reference/) – Complete function documentation