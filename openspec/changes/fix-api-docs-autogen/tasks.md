# Tasks: Fix API Documentation Autogeneration Errors

**Status**: ✅ Completed

## Phase 1: Fix Type Annotations ✅

**Goal**: Resolve all "No type or annotation" warnings from griffe

- [x] Fix `sleap_roots/bases.py` type annotations
  - Line 211: Add type for `lateral_base_ys` parameter
  - Line 213: Add type for `primary_tip_pt_y` parameter
- [x] Fix `sleap_roots/convhull.py` type annotations
  - Line 226: Fix Raises section formatting for ConvexHull ValueError
- [x] Fix `sleap_roots/points.py` type annotations
  - Line 312: Add type for returned value 1
  - Line 313: Add type for returned value 2
  - Line 478: Add type for `points` parameter
  - Line 481: Add type for returned value 1
- [x] Fix `sleap_roots/series.py` type annotations
  - Lines 682-694: Add types for all plot() parameters
- [x] Fix `sleap_roots/trait_pipelines.py` type annotations
  - Line 130: Add type for `obj` parameter
  - Line 133: Add type for returned value
  - Line 411: Add type for returned value
  - Line 660: Add type for returned value
  - Lines 2888, 2923: Fix 'Args' parameter issues

**Validation**: ✅ Run `uv run mkdocs build 2>&1 | grep "No type or annotation"` - returns nothing

---

## Phase 2: Fix Docstring Formatting ✅

**Goal**: Resolve docstring formatting warnings

- [x] Fix `sleap_roots/convhull.py:226` - Reformat Raises section
  - Change "ConvexHull object." to proper exception description
- [x] Fix `sleap_roots/trait_pipelines.py:2888` - Remove invalid 'Args' parameter
- [x] Fix `sleap_roots/trait_pipelines.py:2923` - Remove invalid 'Args' parameter (only line 2888 had duplicate)
- [x] Verify all other docstrings follow Google style

**Validation**: ✅ Run `uv run mkdocs build 2>&1 | grep "WARNING -  griffe"` - returns nothing

---

## Phase 3: Fix Navigation Structure ✅

**Goal**: Resolve navigation warnings and broken links

- [x] Fix `reference/` directory warning
  - **Decision**: Removed `reference/` from nav in mkdocs.yml (auto-generated by gen-files plugin)
- [x] Fix broken notebook link in `docs/api/examples/common-workflows.md`
  - Updated link from `../../notebooks/index.md` to `../../tutorials/index.md`
- [x] Fix broken pipeline link in `docs/guides/custom-pipelines.md`
  - Updated `../api/pipelines.md` to `../api/core/pipelines.md`
- [x] Missing anchors noted as INFO messages only (not blocking)
- [x] benchmarking.md already exists but not causing build warnings

**Validation**: ✅ Run `uv run mkdocs build 2>&1 | grep "WARNING"` - only expected warnings (README.md exclusion)

---

## Phase 4: Testing and Validation ✅

**Goal**: Ensure clean build and verify all fixes

- [x] Run full mkdocs build and capture output
  ```bash
  uv run mkdocs build > build.log 2>&1
  ```
- [x] Verify zero warnings related to:
  - Type annotations ✅
  - Docstring formatting ✅
  - Navigation structure ✅
  - Internal links ✅
- [x] Run pre-merge checks:
  - Black formatting: `uv run black --check sleap_roots tests` ✅
  - pydocstyle: `uv run pydocstyle --convention=google sleap_roots/` ✅
  - pytest: `uv run pytest tests/` ✅ (263 passed, 109 warnings)

**Validation**: ✅ All checks pass, documentation builds cleanly

---

## Phase 5: Documentation ✅

**Goal**: Document changes and update relevant files

- [x] Update this tasks.md with completion status
- [x] Create summary of all changes made (see below)
- [x] Note any decisions made (e.g., how to handle reference/ directory)
- [x] Archive proposal when complete

**Validation**: ✅ Proposal marked as complete and archived

---

## Summary of Changes

### Code Changes (Type Annotations & Docstrings)

**[sleap_roots/bases.py](../../sleap_roots/bases.py:211)**
- Added type annotations to `get_base_median_ratio()` function parameters

**[sleap_roots/convhull.py](../../sleap_roots/convhull.py:226)**
- Fixed Raises section formatting in docstring

**[sleap_roots/points.py](../../sleap_roots/points.py:312)**
- Added return type `Tuple[float, float]` to `get_line_equation_from_points()`
- Added type annotations to `clean_points()` function

**[sleap_roots/series.py](../../sleap_roots/series.py:682)**
- Added type annotations to `plot_instances()` function parameters
- Added `Any` import for `**kwargs` typing

**[sleap_roots/trait_pipelines.py](../../sleap_roots/trait_pipelines.py)**
- Added type annotations to `NumpyArrayEncoder.default()` method
- Added return type annotations to pipeline methods:
  - `compute_multiple_dicots_traits() -> Dict[str, Any]`
  - `compute_multiple_primary_roots_traits() -> Union[Dict[str, Any], pd.DataFrame]`
- Fixed duplicate "Args:" in `PrimaryRootPipeline.get_initial_frame_traits()` docstring
- Updated return docstrings for consistency

### Documentation Changes

**[mkdocs.yml](../../mkdocs.yml:184)**
- Removed `reference/` from navigation (auto-generated by gen-files plugin)

**[docs/api/examples/common-workflows.md](../../docs/api/examples/common-workflows.md:429)**
- Fixed link from `../../notebooks/index.md` to `../../tutorials/index.md`

**[docs/guides/custom-pipelines.md](../../docs/guides/custom-pipelines.md:543)**
- Fixed link from `../api/pipelines.md` to `../api/core/pipelines.md`

### Results
- **Zero griffe warnings** in MkDocs build
- **All pre-merge checks pass**: Black, pydocstyle, pytest
- **Clean documentation build** with only expected warnings
- **Professional quality** API documentation with complete type information

---

## Dependencies

- No dependencies between Phase 1 and Phase 2 (can be done in parallel)
- Phase 3 depends on understanding current navigation structure
- Phase 4 depends on Phases 1-3 completion

## Notes

- Some warnings may be acceptable (document which ones and why)
- Focus on errors that affect user experience first
- Type annotations should match existing code patterns in the repository